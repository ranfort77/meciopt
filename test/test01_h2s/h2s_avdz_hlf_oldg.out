
 ***********************************************************************
 *                            START MECIOPT                            *
 ***********************************************************************


 --------------------
 - Input Parameters -
 --------------------

                PRINT = 1                                                  
               OPTMTD = PF                                                 
           LINESEARCH = HALFSTEP                                           
             PF_ALPHA = 3.5                                                
              PF_BETA = 0.02                                               
            PF_MAXCYC = 30                                                 
          THRESH_STEP = 1e-06                                              
          THRESH_GRAD = 0.005                                              
          THRESH_EGAP = 0.0005                                             
                 NEWG = OLDG                                               
              UPDATEG = BFGS                                               
             OPTCOORD = XYZ                                                
                DIFDR = 0.01                                               
               IDXLOW = 1                                                  
               IDXUPP = 2                                                  
               INPSTR =
***,h2s
memory,128,m

basis = avdz

symmetry,x
geometry={
S
Q 1 LR
H 2 HSR 1 GM
H 2 HSR 1 GMM 3 DD}

LR = 1.7710 bohr
SR = 3.6690 bohr
HSR = SR/2
GM = 90.0 degree
GMM = 180 - GM
DD = 180.0 degree

{hf;occ,7,2;wf,18,1,0}

{multi,maxit=30;
    closed,4,1;
      occ,10,2;
    wf,18,2,0;state,2;weight,0.55,0.45;
    wf,18,1,0;state,1;weight,0.55}

{ci;wf,18,2,0;state,2}

---


 ---------------------
 - Working Directory -
 ---------------------

 make work directory ...
    mkdir h2s_avdz_hlf_oldg
 move to work directory ...
    cd h2s_avdz_hlf_oldg

 ---------------------------
 - Run Initial Calculation -
 ---------------------------

 make & run input ...
    step_001_a.inp
 total wall time: 4.7 sec


 ----------------------------------
 - Summary of Initial Calculation -
 ----------------------------------

 Point group      : Cs
 Symmetry Elements: X

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.10476981
        2       H    0.00000000    1.83450000    1.66623019
        3       H    0.00000000   -1.83450000    1.66623019

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
    RHF-SCF         1       1.1   Singlet     -398.69795726

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.50996717
      MULTI         2       2.2   Singlet     -398.49215290
      MULTI         3       1.1   Singlet     -398.72296725

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.64954490
         CI         2       2.2   Singlet     -398.64276638

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.64276638
      Lower     -398.64954490
      SIGMA     -398.64615564
      GAMMA        0.00677852        0.18445300        4.25358849


 --------------------------------
 - Setup Parameters for Meciopt -
 --------------------------------

           LINESEARCH = HALFSTEP                                           
                PRINT = 1                                                  
              UPDATEG = BFGS                                               
             PF_ALPHA = 3.5                                                
              PF_BETA = 0.02                                               
            PF_MAXCYC = 30                                                 
          THRESH_STEP = 1e-06                                              
          THRESH_GRAD = 0.005                                              
          THRESH_EGAP = 0.0005                                             
                 NEWG = OLDG                                               
                DIFDR = 0.01                                               
               IDXLOW = 1                                                  
               IDXUPP = 2                                                  
                 ATOM = ['S', 'H', 'H']                                    
                NATOM = 3                                                  
               INIXYZ = [[0.0, 0.0, -0.10476981], [0.0, 1.8345, 1.66623019], [0.0, -1.8345, 1.66623019]]
                SYMEL = ['X']                                              
              NSTATES = 2                                                  
         INPSTR_MULTI =
{multi,maxit=30;
closed,4,1;
occ,10,2;
wf,18,2,0;state,2;weight,0.55,0.45;
wf,18,1,0;state,1;weight,0.55}
            INPSTR_CI =
{ci;wf,18,2,0;state,2}

 ---------------------------------------
 - Start Meciopt with Penalty-Function -
 ---------------------------------------

 ----------------------------
  thresholds for convergence 
 ----------------------------
      step =     0.00000100
      grad =     0.00500000
      EGap =     0.00050000
      kmax =   30

 calculate gradients using central difference ...

 make & run input ...
    step_001_nd.inp
 total wall time: 51.63 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.64276640     -398.64954489     -398.64615565        0.00677849

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.64268940     -398.64960210     -398.64268940     -398.64960210
   z1     -398.64159059     -398.64905723     -398.64391154     -398.65000860
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.64304220     -398.64986530     -398.64244390     -398.64924780
   z2     -398.64332334     -398.64979433     -398.64216487     -398.64931667
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.64244390     -398.64924780     -398.64304220     -398.64986530
   z3     -398.64332334     -398.64979433     -398.64216487     -398.64931667

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.64614575     -398.64614575        0.00000000
   z1     -398.64532391     -398.64696007        0.08180800
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.64645375     -398.64584585       -0.03039500
   z2     -398.64655884     -398.64574077       -0.04090325
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.64584585     -398.64645375        0.03039500
   z3     -398.64655884     -398.64574077       -0.04090325

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00691270        0.00691270        0.00000000
   z1        0.00746664        0.00609706        0.06847900
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00682310        0.00680390        0.00096000
   z2        0.00647099        0.00715180       -0.03404050
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00680390        0.00682310       -0.00096000
   z3        0.00647099        0.00715180       -0.03404050

 ---- MECIOPT (k =  1) ----
            PF, alpha =         3.50000000
             PF, beta =         0.02000000
          Lower state =      -398.64954489 a.u.
          Upper state =      -398.64276640 a.u.
                Sigma =      -398.64615565 a.u.
           Energy gap =         0.00677849 a.u. (        0.18445 eV)

          objective L =      -398.64015016 a.u.
            penalty P =         0.00171585 a.u.

    check convergence             value        thresh convsed
             parallel |      0.06544279|   0.00500000   False
        perpendicular        0.04460503    0.00500000   False
                 step |   -398.64015016|   0.00000100   False
           Energy gap        0.00677849    0.00050000   False

 !NOT PASS: step and grad!

 !Initial G is Identity matrix
 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 4.21 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.19866485
        2       H    0.00000000    1.84895462    1.71302334
        3       H    0.00000000   -1.84895462    1.71302334

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.51520563
      MULTI         2       2.2   Singlet     -398.50648289
      MULTI         3       1.1   Singlet     -398.72255685

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.65669502
         CI         2       2.2   Singlet     -398.65463992

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.65463992
      Lower     -398.65669502
      SIGMA     -398.65566747
      GAMMA        0.00205510        0.05592200        1.28959235

               L(k=1) =      -398.64015016
           L(k=1,i=1) =      -398.65499724
                 DIFF =        -0.01484708
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1       -0.18779008       -0.10476981       -0.09389504       -0.19866485
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.02890925        1.83450000        0.01445462        1.84895462
   z2        0.09358631        1.66623019        0.04679315        1.71302334
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.02890925       -1.83450000       -0.01445462       -1.84895462
   z3        0.09358631        1.66623019        0.04679315        1.71302334

         norm of search direction, |p(k)| =         0.23335252
         norm of next step,       |dR(k)| =         0.11667626
 
 calculate gradients using central difference ...

 make & run input ...
    step_002_nd.inp
 total wall time: 49.47 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.65463992     -398.65669502     -398.65566747        0.00205510

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65438086     -398.65694135     -398.65438086     -398.65694135
   z1     -398.65446271     -398.65594070     -398.65480076     -398.65742389
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.65474944     -398.65691903     -398.65438615     -398.65659905
   z2     -398.65465496     -398.65712650     -398.65446871     -398.65640211
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.65438615     -398.65659905     -398.65474944     -398.65691903
   z3     -398.65465496     -398.65712650     -398.65446871     -398.65640211

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.65566111     -398.65566111        0.00000000
   z1     -398.65520170     -398.65611232        0.04553100
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.65583423     -398.65549260       -0.01708175
   z2     -398.65589073     -398.65543541       -0.02276600
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.65549260     -398.65583423        0.01708175
   z3     -398.65589073     -398.65543541       -0.02276600

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00256049        0.00256049        0.00000000
   z1        0.00147799        0.00262313       -0.05725700
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00216959        0.00221290       -0.00216550
   z2        0.00247154        0.00193340        0.02690700
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00221290        0.00216959        0.00216550
   z3        0.00247154        0.00193340        0.02690700

 ---- MECIOPT (k =  2) ----
            PF, alpha =         3.50000000
             PF, beta =         0.02000000
          Lower state =      -398.65669502 a.u.
          Upper state =      -398.65463992 a.u.
                Sigma =      -398.65566747 a.u.
           Energy gap =         0.00205510 a.u. (        0.05592 eV)

          objective L =      -398.65499724 a.u.
            penalty P =         0.00019149 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00337586|   0.00500000    True
        perpendicular        0.02666273    0.00500000   False
                 step |     -0.01484708|   0.00000100   False
           Energy gap        0.00205510    0.00050000   False

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 3.84 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.20134915
        2       H    0.00000000    1.85849869    1.71494855
        3       H    0.00000000   -1.85849869    1.71494855

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.51559721
      MULTI         2       2.2   Singlet     -398.50718893
      MULTI         3       1.1   Singlet     -398.72233173

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.65731959
         CI         2       2.2   Singlet     -398.65505349

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.65505349
      Lower     -398.65731959
      SIGMA     -398.65618654
      GAMMA        0.00226610        0.06166369        1.42199889

               L(k=2) =      -398.65499724
           L(k=2,i=1) =      -398.65537934
                 DIFF =        -0.00038210
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1       -0.00536859       -0.19866485       -0.00268430       -0.20134915
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.01908813        1.84895462        0.00954407        1.85849869
   z2        0.00385041        1.71302334        0.00192520        1.71494855
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.01908813       -1.84895462       -0.00954407       -1.85849869
   z3        0.00385041        1.71302334        0.00192520        1.71494855

         norm of search direction, |p(k)| =         0.02805685
         norm of next step,       |dR(k)| =         0.01402842
 
 calculate gradients using central difference ...

 make & run input ...
    step_003_nd.inp
 total wall time: 49.36 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.65505349     -398.65731959     -398.65618654        0.00226610

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65480882     -398.65755202     -398.65480882     -398.65755202
   z1     -398.65489573     -398.65659002     -398.65519543     -398.65802427
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.65515833     -398.65752418     -398.65481378     -398.65723427
   z2     -398.65506304     -398.65773503     -398.65489895     -398.65703213
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.65481378     -398.65723427     -398.65515833     -398.65752418
   z3     -398.65506304     -398.65773503     -398.65489895     -398.65703213

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.65618042     -398.65618042        0.00000000
   z1     -398.65574287     -398.65660985        0.04334875
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.65634126     -398.65602402       -0.01586150
   z2     -398.65639904     -398.65596554       -0.02167475
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.65602402     -398.65634126        0.01586150
   z3     -398.65639904     -398.65596554       -0.02167475

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00274320        0.00274320        0.00000000
   z1        0.00169429        0.00282884       -0.05672750
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00236585        0.00242049       -0.00273200
   z2        0.00267199        0.00213318        0.02694050
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00242049        0.00236585        0.00273200
   z3        0.00267199        0.00213318        0.02694050

 ---- MECIOPT (k =  3) ----
            PF, alpha =         3.50000000
             PF, beta =         0.02000000
          Lower state =      -398.65731959 a.u.
          Upper state =      -398.65505349 a.u.
                Sigma =      -398.65618654 a.u.
           Energy gap =         0.00226610 a.u. (        0.06166 eV)

          objective L =      -398.65537934 a.u.
            penalty P =         0.00023063 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00155608|   0.00500000    True
        perpendicular        0.02542403    0.00500000   False
                 step |     -0.00038210|   0.00000100   False
           Energy gap        0.00226610    0.00050000   False

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 4.16 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.20904400
        2       H    0.00000000    1.93101552    1.72272502
        3       H    0.00000000   -1.93101552    1.72272502

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.51769455
      MULTI         2       2.2   Singlet     -398.51015705
      MULTI         3       1.1   Singlet     -398.72010406

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.65973044
         CI         2       2.2   Singlet     -398.65735522

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.65735522
      Lower     -398.65973044
      SIGMA     -398.65854283
      GAMMA        0.00237522        0.06463293        1.49047112

               L(k=3) =      -398.65537934
           L(k=3,i=1) =      -398.65766034
                 DIFF =        -0.00228100
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1       -0.01538970       -0.20134915       -0.00769485       -0.20904400
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.14503367        1.85849869        0.07251683        1.93101552
   z2        0.01555294        1.71494855        0.00777647        1.72272502
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.14503367       -1.85849869       -0.07251683       -1.93101552
   z3        0.01555294        1.71494855        0.00777647        1.72272502

         norm of search direction, |p(k)| =         0.20685783
         norm of next step,       |dR(k)| =         0.10342891
 
 calculate gradients using central difference ...

 make & run input ...
    step_004_nd.inp
 total wall time: 49.21 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.65735522     -398.65973044     -398.65854283        0.00237522

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65709091     -398.65998501     -398.65709091     -398.65998501
   z1     -398.65729719     -398.65912413     -398.65740057     -398.66031483
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.65740639     -398.65985119     -398.65715912     -398.65974239
   z2     -398.65731403     -398.66008823     -398.65724924     -398.65950593
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.65715912     -398.65974239     -398.65740639     -398.65985119
   z3     -398.65731403     -398.66008823     -398.65724924     -398.65950593

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.65853796     -398.65853796        0.00000000
   z1     -398.65821066     -398.65885770        0.03235200
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.65862879     -398.65845075       -0.00890175
   z2     -398.65870113     -398.65837759       -0.01617725
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.65845075     -398.65862879        0.00890175
   z3     -398.65870113     -398.65837759       -0.01617725

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00289410        0.00289410        0.00000000
   z1        0.00182694        0.00291426       -0.05436600
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00244480        0.00258327       -0.00692350
   z2        0.00277420        0.00225669        0.02587550
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00258327        0.00244480        0.00692350
   z3        0.00277420        0.00225669        0.02587550

 ---- MECIOPT (k =  4) ----
            PF, alpha =         3.50000000
             PF, beta =         0.02000000
          Lower state =      -398.65973044 a.u.
          Upper state =      -398.65735522 a.u.
                Sigma =      -398.65854283 a.u.
           Energy gap =         0.00237522 a.u. (        0.06463 eV)

          objective L =      -398.65766034 a.u.
            penalty P =         0.00025214 a.u.

    check convergence             value        thresh convsed
             parallel |      0.00265884|   0.00500000    True
        perpendicular        0.01832716    0.00500000   False
                 step |     -0.00228100|   0.00000100   False
           Energy gap        0.00237522    0.00050000   False

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 3.93 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.21363541
        2       H    0.00000000    2.03515130    1.73098471
        3       H    0.00000000   -2.03515130    1.73098471

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.51966130
      MULTI         2       2.2   Singlet     -398.51162116
      MULTI         3       1.1   Singlet     -398.71477889

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66038297
         CI         2       2.2   Singlet     -398.65956441

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.65956441
      Lower     -398.66038297
      SIGMA     -398.65997369
      GAMMA        0.00081856        0.02227416        0.51365437

               L(k=4) =      -398.65766034
           L(k=4,i=1) =      -398.65986104
                 DIFF =        -0.00220070
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1       -0.00918282       -0.20904400       -0.00459141       -0.21363541
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.20827154        1.93101552        0.10413577        2.03515130
   z2        0.01651938        1.72272502        0.00825969        1.73098471
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.20827154       -1.93101552       -0.10413577       -2.03515130
   z3        0.01651938        1.72272502        0.00825969        1.73098471

         norm of search direction, |p(k)| =         0.29560814
         norm of next step,       |dR(k)| =         0.14780407
 
 calculate gradients using central difference ...

 make & run input ...
    step_005_nd.inp
 total wall time: 52.5 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.65956441     -398.66038297     -398.65997369        0.00081856

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65900029     -398.66093945     -398.65900029     -398.66093945
   z1     -398.65960427     -398.65989621     -398.65951555     -398.66085051
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.65943597     -398.66054665     -398.65930189     -398.66060142
   z2     -398.65939421     -398.66076412     -398.65936082     -398.66036468
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.65930189     -398.66060142     -398.65943597     -398.66054665
   z3     -398.65939421     -398.66076412     -398.65936082     -398.66036468

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.65996987     -398.65996987        0.00000000
   z1     -398.65975024     -398.66018303        0.02163950
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.65999131     -398.65995165       -0.00198275
   z2     -398.66007917     -398.65986275       -0.01082075
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.65995165     -398.65999131        0.00198275
   z3     -398.66007917     -398.65986275       -0.01082075

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00193916        0.00193916        0.00000000
   z1        0.00029194        0.00133496       -0.05215100
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00111068        0.00129953       -0.00944250
   z2        0.00136991        0.00100386        0.01830250
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00129953        0.00111068        0.00944250
   z3        0.00136991        0.00100386        0.01830250

 ---- MECIOPT (k =  5) ----
            PF, alpha =         3.50000000
             PF, beta =         0.02000000
          Lower state =      -398.66038297 a.u.
          Upper state =      -398.65956441 a.u.
                Sigma =      -398.65997369 a.u.
           Energy gap =         0.00081856 a.u. (        0.02227 eV)

          objective L =      -398.65986104 a.u.
            penalty P =         0.00003218 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00250854|   0.00500000    True
        perpendicular        0.00951026    0.00500000   False
                 step |     -0.00220070|   0.00000100   False
           Energy gap        0.00081856    0.00050000   False

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 3.92 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.21731962
        2       H    0.00000000    2.07152936    1.73636237
        3       H    0.00000000   -2.07152936    1.73636237

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52022979
      MULTI         2       2.2   Singlet     -398.51188920
      MULTI         3       1.1   Singlet     -398.71210590

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66031071
         CI         2       2.2   Singlet     -398.66013449

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66013449
      Lower     -398.66031071
      SIGMA     -398.66022260
      GAMMA        0.00017622        0.00479512        0.11057823

               L(k=5) =      -398.65986104
           L(k=5,i=1) =      -398.66021721
                 DIFF =        -0.00035617
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1       -0.00736843       -0.21363541       -0.00368421       -0.21731962
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.07275613        2.03515130        0.03637807        2.07152936
   z2        0.01075532        1.73098471        0.00537766        1.73636237
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.07275613       -2.03515130       -0.03637807       -2.07152936
   z3        0.01075532        1.73098471        0.00537766        1.73636237

         norm of search direction, |p(k)| =         0.10427156
         norm of next step,       |dR(k)| =         0.05213578
 
 calculate gradients using central difference ...

 make & run input ...
    step_006_nd.inp
 total wall time: 50.96 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.66013449     -398.66031071     -398.66022260        0.00017622

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65932037     -398.66111780     -398.65932037     -398.66111780
   z1     -398.65986575     -398.66020698     -398.66005419     -398.66073738
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.65977209     -398.66066889     -398.65974282     -398.66069879
   z2     -398.65983401     -398.66078591     -398.65970812     -398.66055232
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.65974282     -398.66069879     -398.65977209     -398.66066889
   z3     -398.65983401     -398.66078591     -398.65970812     -398.66055232

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.66021908     -398.66021908        0.00000000
   z1     -398.66003636     -398.66039578        0.01797100
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.66022049     -398.66022080        0.00001575
   z2     -398.66030996     -398.66013022       -0.00898700
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.66022080     -398.66022049       -0.00001575
   z3     -398.66030996     -398.66013022       -0.00898700

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00179743        0.00179743        0.00000000
   z1        0.00034123        0.00068319       -0.01709800
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00089680        0.00095597       -0.00295850
   z2        0.00095190        0.00084420        0.00538500
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00095597        0.00089680        0.00295850
   z3        0.00095190        0.00084420        0.00538500

 ---- MECIOPT (k =  6) ----
            PF, alpha =         3.50000000
             PF, beta =         0.02000000
          Lower state =      -398.66031071 a.u.
          Upper state =      -398.66013449 a.u.
                Sigma =      -398.66022260 a.u.
           Energy gap =         0.00017622 a.u. (        0.00480 eV)

          objective L =      -398.66021721 a.u.
            penalty P =         0.00000154 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00568710|   0.00500000   False
        perpendicular        0.00635978    0.00500000   False
                 step |     -0.00035617|   0.00000100   False
           Energy gap        0.00017622    0.00050000    True

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 4.19 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.22328284
        2       H    0.00000000    2.09030049    1.74074800
        3       H    0.00000000   -2.09030049    1.74074800

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52049544
      MULTI         2       2.2   Singlet     -398.51221643
      MULTI         3       1.1   Singlet     -398.71029520

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66040637
         CI         2       2.2   Singlet     -398.66034227

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66034227
      Lower     -398.66040637
      SIGMA     -398.66037432
      GAMMA        0.00006410        0.00174423        0.04022295

               L(k=6) =      -398.66021721
           L(k=6,i=1) =      -398.66037360
                 DIFF =        -0.00015639
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1       -0.01192643       -0.21731962       -0.00596321       -0.22328284
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.03754225        2.07152936        0.01877113        2.09030049
   z2        0.00877126        1.73636237        0.00438563        1.74074800
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.03754225       -2.07152936       -0.01877113       -2.09030049
   z3        0.00877126        1.73636237        0.00438563        1.74074800

         norm of search direction, |p(k)| =         0.05581175
         norm of next step,       |dR(k)| =         0.02790587
 
 calculate gradients using central difference ...

 make & run input ...
    step_007_nd.inp
 total wall time: 50.06 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.66034227     -398.66040637     -398.66037432        0.00006410

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65946702     -398.66127508     -398.65946702     -398.66127508
   z1     -398.65999092     -398.66043504     -398.66024217     -398.66080435
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.65990513     -398.66081777     -398.65991640     -398.66085076
   z2     -398.65999439     -398.66090466     -398.65986098     -398.66072776
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.65991640     -398.66085076     -398.65990513     -398.66081777
   z3     -398.65999439     -398.66090466     -398.65986098     -398.66072776

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.66037105     -398.66037105        0.00000000
   z1     -398.66021298     -398.66052326        0.01551400
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.66036145     -398.66038358        0.00110650
   z2     -398.66044952     -398.66029437       -0.00775775
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.66038358     -398.66036145       -0.00110650
   z3     -398.66044952     -398.66029437       -0.00775775

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00180806        0.00180806        0.00000000
   z1        0.00044412        0.00056218       -0.00590300
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00091264        0.00093436       -0.00108600
   z2        0.00091027        0.00086678        0.00217450
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00093436        0.00091264        0.00108600
   z3        0.00091027        0.00086678        0.00217450

 ---- MECIOPT (k =  7) ----
            PF, alpha =         3.50000000
             PF, beta =         0.02000000
          Lower state =      -398.66040637 a.u.
          Upper state =      -398.66034227 a.u.
                Sigma =      -398.66037432 a.u.
           Energy gap =         0.00006410 a.u. (        0.00174 eV)

          objective L =      -398.66037360 a.u.
            penalty P =         0.00000020 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00529858|   0.00500000   False
        perpendicular        0.00372829    0.00500000    True
                 step |     -0.00015639|   0.00000100   False
           Energy gap        0.00006410    0.00050000    True

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 3.88 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.23082915
        2       H    0.00000000    2.10550380    1.74589100
        3       H    0.00000000   -2.10550380    1.74589100

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52067966
      MULTI         2       2.2   Singlet     -398.51262587
      MULTI         3       1.1   Singlet     -398.70850478

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66058233
         CI         2       2.2   Singlet     -398.66043314

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66043314
      Lower     -398.66058233
      SIGMA     -398.66050773
      GAMMA        0.00014918        0.00405948        0.09361380

               L(k=7) =      -398.66037360
           L(k=7,i=1) =      -398.66050387
                 DIFF =        -0.00013027
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1       -0.01509263       -0.22328284       -0.00754632       -0.23082915
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.03040663        2.09030049        0.01520331        2.10550380
   z2        0.01028601        1.74074800        0.00514300        1.74589100
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.03040663       -2.09030049       -0.01520331       -2.10550380
   z3        0.01028601        1.74074800        0.00514300        1.74589100

         norm of search direction, |p(k)| =         0.04783846
         norm of next step,       |dR(k)| =         0.02391923
 
 calculate gradients using central difference ...

 make & run input ...
    step_008_nd.inp
 total wall time: 49.77 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.66043314     -398.66058233     -398.66050774        0.00014919

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65959007     -398.66141942     -398.65959007     -398.66141942
   z1     -398.66019638     -398.66054486     -398.66031484     -398.66095131
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.66002850     -398.66094282     -398.66004120     -398.66101184
   z2     -398.66009753     -398.66104476     -398.66001055     -398.66086924
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.66004120     -398.66101184     -398.66002850     -398.66094282
   z3     -398.66009753     -398.66104476     -398.66001055     -398.66086924

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.66050475     -398.66050475        0.00000000
   z1     -398.66037062     -398.66063307        0.01312275
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.66048566     -398.66052652        0.00204300
   z2     -398.66057114     -398.66043989       -0.00656250
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.66052652     -398.66048566       -0.00204300
   z3     -398.66057114     -398.66043989       -0.00656250

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00182935        0.00182935        0.00000000
   z1        0.00034848        0.00063647       -0.01439950
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00091432        0.00097064       -0.00281600
   z2        0.00094723        0.00085869        0.00442700
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00097064        0.00091432        0.00281600
   z3        0.00094723        0.00085869        0.00442700

 ---- MECIOPT (k =  8) ----
            PF, alpha =         3.50000000
             PF, beta =         0.02000000
          Lower state =      -398.66058233 a.u.
          Upper state =      -398.66043314 a.u.
                Sigma =      -398.66050774 a.u.
           Energy gap =         0.00014919 a.u. (        0.00406 eV)

          objective L =      -398.66050387 a.u.
            penalty P =         0.00000110 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00432168|   0.00500000    True
        perpendicular        0.00344818    0.00500000    True
                 step |     -0.00013027|   0.00000100   False
           Energy gap        0.00014919    0.00050000    True

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 3.82 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.23822108
        2       H    0.00000000    2.11421564    1.75099175
        3       H    0.00000000   -2.11421564    1.75099175

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52074940
      MULTI         2       2.2   Singlet     -398.51306611
      MULTI         3       1.1   Singlet     -398.70712552

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66083497
         CI         2       2.2   Singlet     -398.66040190

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66040190
      Lower     -398.66083497
      SIGMA     -398.66061844
      GAMMA        0.00043308        0.01178468        0.27176127

               L(k=8) =      -398.66050387
           L(k=8,i=1) =      -398.66058631
                 DIFF =        -0.00008244
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1       -0.01478386       -0.23082915       -0.00739193       -0.23822108
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.01742368        2.10550380        0.00871184        2.11421564
   z2        0.01020149        1.74589100        0.00510074        1.75099175
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.01742368       -2.10550380       -0.00871184       -2.11421564
   z3        0.01020149        1.74589100        0.00510074        1.75099175

         norm of search direction, |p(k)| =         0.03215388
         norm of next step,       |dR(k)| =         0.01607694
 
 calculate gradients using central difference ...

 make & run input ...
    step_009_nd.inp
 total wall time: 50.2 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.66040190     -398.66083497     -398.66061844        0.00043307

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65967233     -398.66155911     -398.65967233     -398.66155911
   z1     -398.66047351     -398.66052774     -398.66027005     -398.66117987
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.66011433     -398.66106592     -398.66008929     -398.66119821
   z2     -398.66012271     -398.66122224     -398.66011939     -398.66100114
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.66008929     -398.66119821     -398.66011433     -398.66106592
   z3     -398.66012271     -398.66122224     -398.66011939     -398.66100114

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.66061572     -398.66061572        0.00000000
   z1     -398.66050062     -398.66072496        0.01121675
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.66059012     -398.66064375        0.00268125
   z2     -398.66067247     -398.66056026       -0.00561050
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.66064375     -398.66059012       -0.00268125
   z3     -398.66067247     -398.66056026       -0.00561050

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00188678        0.00188678        0.00000000
   z1        0.00005423        0.00090982       -0.04277950
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00095159        0.00110892       -0.00786650
   z2        0.00109953        0.00088175        0.01088900
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00110892        0.00095159        0.00786650
   z3        0.00109953        0.00088175        0.01088900

 ---- MECIOPT (k =  9) ----
            PF, alpha =         3.50000000
             PF, beta =         0.02000000
          Lower state =      -398.66083497 a.u.
          Upper state =      -398.66040190 a.u.
                Sigma =      -398.66061844 a.u.
           Energy gap =         0.00043307 a.u. (        0.01178 eV)

          objective L =      -398.66058631 a.u.
            penalty P =         0.00000918 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00196915|   0.00500000    True
        perpendicular        0.00370543    0.00500000    True
                 step |     -0.00008244|   0.00000100   False
           Energy gap        0.00043307    0.00050000    True

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 4.11 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.24006397
        2       H    0.00000000    2.11486967    1.75361558
        3       H    0.00000000   -2.11486967    1.75361558

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52073563
      MULTI         2       2.2   Singlet     -398.51325372
      MULTI         3       1.1   Singlet     -398.70680287

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66097473
         CI         2       2.2   Singlet     -398.66035281

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66035281
      Lower     -398.66097473
      SIGMA     -398.66066377
      GAMMA        0.00062192        0.01692338        0.39026257

               L(k=9) =      -398.66058631
           L(k=9,i=1) =      -398.66059812
                 DIFF =        -0.00001181
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1       -0.00368577       -0.23822108       -0.00184289       -0.24006397
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.00130806        2.11421564        0.00065403        2.11486967
   z2        0.00524766        1.75099175        0.00262383        1.75361558
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.00130806       -2.11421564       -0.00065403       -2.11486967
   z3        0.00524766        1.75099175        0.00262383        1.75361558

         norm of search direction, |p(k)| =         0.00849017
         norm of next step,       |dR(k)| =         0.00424508
 
 calculate gradients using central difference ...

 make & run input ...
    step_010_nd.inp
 total wall time: 50.3 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.66035281     -398.66097473     -398.66066377        0.00062192

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65968944     -398.66163280     -398.65968944     -398.66163280
   z1     -398.66048175     -398.66062098     -398.66021722     -398.66131263
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.66012482     -398.66114340     -398.66007687     -398.66130400
   z2     -398.66010198     -398.66132824     -398.66013569     -398.66108090
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.66007687     -398.66130400     -398.66012482     -398.66114340
   z3     -398.66010198     -398.66132824     -398.66013569     -398.66108090

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.66066112     -398.66066112        0.00000000
   z1     -398.66055136     -398.66076492        0.01067800
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.66063411     -398.66069043        0.00281625
   z2     -398.66071511     -398.66060829       -0.00534075
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.66069043     -398.66063411       -0.00281625
   z3     -398.66071511     -398.66060829       -0.00534075

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00194336        0.00194336        0.00000000
   z1        0.00013923        0.00109541       -0.04780900
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00101858        0.00122713       -0.01042750
   z2        0.00122626        0.00094521        0.01405250
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00122713        0.00101858        0.01042750
   z3        0.00122626        0.00094521        0.01405250

 ---- MECIOPT (k = 10) ----
            PF, alpha =         3.50000000
             PF, beta =         0.02000000
          Lower state =      -398.66097473 a.u.
          Upper state =      -398.66035281 a.u.
                Sigma =      -398.66066377 a.u.
           Energy gap =         0.00062192 a.u. (        0.01692 eV)

          objective L =      -398.66059812 a.u.
            penalty P =         0.00001876 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00061964|   0.00500000    True
        perpendicular        0.00289526    0.00500000    True
                 step |     -0.00001181|   0.00000100   False
           Energy gap        0.00062192    0.00050000   False

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 3.84 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.24014064
        2       H    0.00000000    2.11518527    1.75576055
        3       H    0.00000000   -2.11518527    1.75576055

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52072774
      MULTI         2       2.2   Singlet     -398.51334645
      MULTI         3       1.1   Singlet     -398.70664202

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66104333
         CI         2       2.2   Singlet     -398.66032748

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66032748
      Lower     -398.66104333
      SIGMA     -398.66068540
      GAMMA        0.00071585        0.01947934        0.44920436

              L(k=10) =      -398.66059812
          L(k=10,i=1) =      -398.66059883
                 DIFF =        -0.00000070
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1       -0.00015333       -0.24006397       -0.00007667       -0.24014064
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.00063119        2.11486967        0.00031559        2.11518527
   z2        0.00428994        1.75361558        0.00214497        1.75576055
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.00063119       -2.11486967       -0.00031559       -2.11518527
   z3        0.00428994        1.75361558        0.00214497        1.75576055

         norm of search direction, |p(k)| =         0.00613412
         norm of next step,       |dR(k)| =         0.00306706
 
 calculate gradients using central difference ...

 make & run input ...
    step_011_nd.inp
 total wall time: 52.13 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.66032748     -398.66104333     -398.66068540        0.00071585

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65969397     -398.66167165     -398.65969397     -398.66167165
   z1     -398.66045806     -398.66069328     -398.66019017     -398.66137767
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.66012367     -398.66118654     -398.66006665     -398.66135882
   z2     -398.66008809     -398.66138277     -398.66013675     -398.66112581
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.66006665     -398.66135882     -398.66012367     -398.66118654
   z3     -398.66008809     -398.66138277     -398.66013675     -398.66112581

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.66068281     -398.66068281        0.00000000
   z1     -398.66057567     -398.66078392        0.01041250
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.66065511     -398.66071273        0.00288150
   z2     -398.66073543     -398.66063128       -0.00520750
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.66071273     -398.66065511       -0.00288150
   z3     -398.66073543     -398.66063128       -0.00520750

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00197768        0.00197768        0.00000000
   z1        0.00023522        0.00118750       -0.04761400
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00106287        0.00129217       -0.01146500
   z2        0.00129468        0.00098906        0.01528100
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00129217        0.00106287        0.01146500
   z3        0.00129468        0.00098906        0.01528100

 ---- MECIOPT (k = 11) ----
            PF, alpha =         3.50000000
             PF, beta =         0.02000000
          Lower state =      -398.66104333 a.u.
          Upper state =      -398.66032748 a.u.
                Sigma =      -398.66068540 a.u.
           Energy gap =         0.00071585 a.u. (        0.01948 eV)

          objective L =      -398.66059883 a.u.
            penalty P =         0.00002474 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00004481|   0.00500000    True
        perpendicular        0.00240962    0.00500000    True
                 step |     -0.00000070|   0.00000100    True
           Energy gap        0.00071585    0.00050000   False

 !PASS: step and grad!
 !NOT PASS: egap

 !UPDATE: alpha = 2*alpha

 !SET: G(k-1) = OLDG 

 !SET: F(k-1) for new alpha 

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 3.82 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.23838066
        2       H    0.00000000    2.11561066    1.75644841
        3       H    0.00000000   -2.11561066    1.75644841

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52074018
      MULTI         2       2.2   Singlet     -398.51329201
      MULTI         3       1.1   Singlet     -398.70667726

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66099604
         CI         2       2.2   Singlet     -398.66034746

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66034746
      Lower     -398.66099604
      SIGMA     -398.66067175
      GAMMA        0.00064858        0.01764876        0.40699011

              L(k=11) =      -398.66051225
          L(k=11,i=1) =      -398.66052914
                 DIFF =        -0.00001690
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1        0.00351995       -0.24014064        0.00175997       -0.23838066
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.00085078        2.11518527        0.00042539        2.11561066
   z2        0.00137572        1.75576055        0.00068786        1.75644841
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.00085078       -2.11518527       -0.00042539       -2.11561066
   z3        0.00137572        1.75576055        0.00068786        1.75644841

         norm of search direction, |p(k)| =         0.00419796
         norm of next step,       |dR(k)| =         0.00209898
 
 calculate gradients using central difference ...

 make & run input ...
    step_012_nd.inp
 total wall time: 50.6 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.66034746     -398.66099604     -398.66067175        0.00064858

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65969247     -398.66164575     -398.65969247     -398.66164575
   z1     -398.66047746     -398.66064455     -398.66021060     -398.66133190
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.66012623     -398.66115687     -398.66007606     -398.66132184
   z2     -398.66009952     -398.66134500     -398.66013847     -398.66109574
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.66007606     -398.66132184     -398.66012623     -398.66115687
   z3     -398.66009952     -398.66134500     -398.66013847     -398.66109574

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.66066911     -398.66066911        0.00000000
   z1     -398.66056100     -398.66077125        0.01051225
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.66064155     -398.66069895        0.00287000
   z2     -398.66072226     -398.66061711       -0.00525775
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.66069895     -398.66064155       -0.00287000
   z3     -398.66072226     -398.66061711       -0.00525775

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00195328        0.00195328        0.00000000
   z1        0.00016709        0.00112130       -0.04771050
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00103064        0.00124578       -0.01075700
   z2        0.00124548        0.00095727        0.01441050
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00124578        0.00103064        0.01075700
   z3        0.00124548        0.00095727        0.01441050

 ---- MECIOPT (k = 12) ----
            PF, alpha =         7.00000000
             PF, beta =         0.02000000
          Lower state =      -398.66099604 a.u.
          Upper state =      -398.66034746 a.u.
                Sigma =      -398.66067175 a.u.
           Energy gap =         0.00064858 a.u. (        0.01765 eV)

          objective L =      -398.66052914 a.u.
            penalty P =         0.00002037 a.u.

    check convergence             value        thresh convsed
             parallel |      0.00145429|   0.00500000    True
        perpendicular        0.00273141    0.00500000    True
                 step |     -0.00001690|   0.00000100   False
           Energy gap        0.00064858    0.00050000   False

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 4.14 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.22587300
        2       H    0.00000000    2.11785246    1.76599987
        3       H    0.00000000   -2.11785246    1.76599987

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52078966
      MULTI         2       2.2   Singlet     -398.51312375
      MULTI         3       1.1   Singlet     -398.70669485

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66083855
         CI         2       2.2   Singlet     -398.66041643

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66041643
      Lower     -398.66083855
      SIGMA     -398.66062749
      GAMMA        0.00042212        0.01148649        0.26488472

              L(k=12) =      -398.66052914
          L(k=12,i=1) =      -398.66056641
                 DIFF =        -0.00003727
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1        0.02501533       -0.23838066        0.01250766       -0.22587300
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.00448361        2.11561066        0.00224180        2.11785246
   z2        0.01910291        1.75644841        0.00955146        1.76599987
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.00448361       -2.11561066       -0.00224180       -2.11785246
   z3        0.01910291        1.75644841        0.00955146        1.76599987

         norm of search direction, |p(k)| =         0.03736060
         norm of next step,       |dR(k)| =         0.01868030
 
 calculate gradients using central difference ...

 make & run input ...
    step_013_nd.inp
 total wall time: 50.95 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.66041643     -398.66083855     -398.66062749        0.00042212

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65968111     -398.66156843     -398.65968111     -398.66156843
   z1     -398.66048344     -398.66054561     -398.66028045     -398.66117794
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.66012225     -398.66107222     -398.66010186     -398.66120754
   z2     -398.66013229     -398.66122588     -398.66013126     -398.66101218
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.66010186     -398.66120754     -398.66012225     -398.66107222
   z3     -398.66013229     -398.66122588     -398.66013126     -398.66101218

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.66062477     -398.66062477        0.00000000
   z1     -398.66051452     -398.66072920        0.01073350
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.66059723     -398.66065470        0.00287325
   z2     -398.66067908     -398.66057172       -0.00536825
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.66065470     -398.66059723       -0.00287325
   z3     -398.66067908     -398.66057172       -0.00536825

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00188732        0.00188732        0.00000000
   z1        0.00006217        0.00089749       -0.04176600
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00094997        0.00110568       -0.00778550
   z2        0.00109359        0.00088092        0.01063350
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00110568        0.00094997        0.00778550
   z3        0.00109359        0.00088092        0.01063350

 ---- MECIOPT (k = 13) ----
            PF, alpha =         7.00000000
             PF, beta =         0.02000000
          Lower state =      -398.66083855 a.u.
          Upper state =      -398.66041643 a.u.
                Sigma =      -398.66062749 a.u.
           Energy gap =         0.00042212 a.u. (        0.01149 eV)

          objective L =      -398.66056641 a.u.
            penalty P =         0.00000873 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00002545|   0.00500000    True
        perpendicular        0.00361887    0.00500000    True
                 step |     -0.00003727|   0.00000100   False
           Energy gap        0.00042212    0.00050000    True

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 3.86 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.21739008
        2       H    0.00000000    2.12132461    1.77569529
        3       H    0.00000000   -2.12132461    1.77569529

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52083368
      MULTI         2       2.2   Singlet     -398.51311881
      MULTI         3       1.1   Singlet     -398.70636267

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66079363
         CI         2       2.2   Singlet     -398.66044606

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66044606
      Lower     -398.66079363
      SIGMA     -398.66061984
      GAMMA        0.00034756        0.00945767        0.21809905

              L(k=13) =      -398.66056641
          L(k=13,i=1) =      -398.66057829
                 DIFF =        -0.00001187
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1        0.01696584       -0.22587300        0.00848292       -0.21739008
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.00694429        2.11785246        0.00347215        2.12132461
   z2        0.01939085        1.76599987        0.00969543        1.77569529
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.00694429       -2.11785246       -0.00347215       -2.12132461
   z3        0.01939085        1.76599987        0.00969543        1.77569529

         norm of search direction, |p(k)| =         0.03370900
         norm of next step,       |dR(k)| =         0.01685450
 
 calculate gradients using central difference ...

 make & run input ...
    step_014_nd.inp
 total wall time: 51.53 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.66044606     -398.66079363     -398.66061985        0.00034757

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65968048     -398.66155385     -398.65968048     -398.66155385
   z1     -398.66044191     -398.66057815     -398.66030763     -398.66112944
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.66012068     -398.66105564     -398.66011474     -398.66118239
   z2     -398.66014517     -398.66119471     -398.66013139     -398.66099992
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.66011474     -398.66118239     -398.66012068     -398.66105564
   z3     -398.66014517     -398.66119471     -398.66013139     -398.66099992

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.66061717     -398.66061717        0.00000000
   z1     -398.66051003     -398.66071854        0.01042525
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.66058816     -398.66064856        0.00302025
   z2     -398.66066994     -398.66056566       -0.00521425
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.66064856     -398.66058816       -0.00302025
   z3     -398.66066994     -398.66056566       -0.00521425

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00187337        0.00187337        0.00000000
   z1        0.00013624        0.00082181       -0.03427850
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00093496        0.00106765       -0.00663450
   z2        0.00104954        0.00086853        0.00905050
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00106765        0.00093496        0.00663450
   z3        0.00104954        0.00086853        0.00905050

 ---- MECIOPT (k = 14) ----
            PF, alpha =         7.00000000
             PF, beta =         0.02000000
          Lower state =      -398.66079363 a.u.
          Upper state =      -398.66044606 a.u.
                Sigma =      -398.66061985 a.u.
           Energy gap =         0.00034757 a.u. (        0.00946 eV)

          objective L =      -398.66057829 a.u.
            penalty P =         0.00000594 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00058055|   0.00500000    True
        perpendicular        0.00343270    0.00500000    True
                 step |     -0.00001187|   0.00000100   False
           Energy gap        0.00034757    0.00050000    True

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 3.85 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.21081162
        2       H    0.00000000    2.12492003    1.78508127
        3       H    0.00000000   -2.12492003    1.78508127

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52087028
      MULTI         2       2.2   Singlet     -398.51317912
      MULTI         3       1.1   Singlet     -398.70591930

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66079738
         CI         2       2.2   Singlet     -398.66045472

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66045472
      Lower     -398.66079738
      SIGMA     -398.66062605
      GAMMA        0.00034266        0.00932425        0.21502242

              L(k=14) =      -398.66057829
          L(k=14,i=1) =      -398.66058565
                 DIFF =        -0.00000736
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1        0.01315692       -0.21739008        0.00657846       -0.21081162
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.00719085        2.12132461        0.00359543        2.12492003
   z2        0.01877194        1.77569529        0.00938597        1.78508127
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.00719085       -2.12132461       -0.00359543       -2.12492003
   z3        0.01877194        1.77569529        0.00938597        1.78508127

         norm of search direction, |p(k)| =         0.03132559
         norm of next step,       |dR(k)| =         0.01566280
 
 calculate gradients using central difference ...

 make & run input ...
    step_015_nd.inp
 total wall time: 50.48 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.66045472     -398.66079738     -398.66062605        0.00034266

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65968580     -398.66156102     -398.65968580     -398.66156102
   z1     -398.66045169     -398.66059065     -398.66031258     -398.66112727
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.66012490     -398.66106012     -398.66012301     -398.66119036
   z2     -398.66015018     -398.66119728     -398.66013973     -398.66100891
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.66012301     -398.66119036     -398.66012490     -398.66106012
   z3     -398.66015018     -398.66119728     -398.66013973     -398.66100891

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.66062341     -398.66062341        0.00000000
   z1     -398.66052117     -398.66071992        0.00993775
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.66059251     -398.66065668        0.00320875
   z2     -398.66067373     -398.66057432       -0.00497050
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.66065668     -398.66059251       -0.00320875
   z3     -398.66067373     -398.66057432       -0.00497050

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00187522        0.00187522        0.00000000
   z1        0.00013896        0.00081469       -0.03378650
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00093522        0.00106735       -0.00660650
   z2        0.00104710        0.00086918        0.00889600
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00106735        0.00093522        0.00660650
   z3        0.00104710        0.00086918        0.00889600

 ---- MECIOPT (k = 15) ----
            PF, alpha =         7.00000000
             PF, beta =         0.02000000
          Lower state =      -398.66079738 a.u.
          Upper state =      -398.66045472 a.u.
                Sigma =      -398.66062605 a.u.
           Energy gap =         0.00034266 a.u. (        0.00932 eV)

          objective L =      -398.66058565 a.u.
            penalty P =         0.00000577 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00054560|   0.00500000    True
        perpendicular        0.00343642    0.00500000    True
                 step |     -0.00000736|   0.00000100   False
           Energy gap        0.00034266    0.00050000    True

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 4.2 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.16259581
        2       H    0.00000000    2.13820972    1.84473829
        3       H    0.00000000   -2.13820972    1.84473829

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52099073
      MULTI         2       2.2   Singlet     -398.51341920
      MULTI         3       1.1   Singlet     -398.70417959

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66081379
         CI         2       2.2   Singlet     -398.66045519

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66045519
      Lower     -398.66081379
      SIGMA     -398.66063449
      GAMMA        0.00035859        0.00975782        0.22502076

              L(k=15) =      -398.66058565
          L(k=15,i=1) =      -398.66059027
                 DIFF =        -0.00000463
 !FIND step length
 !step length =     0.50000000

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1        0.09643162       -0.21081162        0.04821581       -0.16259581
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.02657938        2.12492003        0.01328969        2.13820972
   z2        0.11931406        1.78508127        0.05965703        1.84473829
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.02657938       -2.12492003       -0.01328969       -2.13820972
   z3        0.11931406        1.78508127        0.05965703        1.84473829

         norm of search direction, |p(k)| =         0.19794866
         norm of next step,       |dR(k)| =         0.09897433
 
 calculate gradients using central difference ...

 make & run input ...
    step_016_nd.inp
 total wall time: 49.56 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.66045519     -398.66081379     -398.66063449        0.00035860

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65968811     -398.66157618     -398.65968811     -398.66157618
   z1     -398.66049104     -398.66060605     -398.66029954     -398.66112066
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.66012350     -398.66106505     -398.66013064     -398.66121380
   z2     -398.66014472     -398.66120146     -398.66015418     -398.66103037
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.66013064     -398.66121380     -398.66012350     -398.66106505
   z3     -398.66014472     -398.66120146     -398.66015418     -398.66103037

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.66063215     -398.66063215        0.00000000
   z1     -398.66054854     -398.66071010        0.00807775
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.66059427     -398.66067222        0.00389725
   z2     -398.66067309     -398.66059227       -0.00404075
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.66067222     -398.66059427       -0.00389725
   z3     -398.66067309     -398.66059227       -0.00404075

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00188807        0.00188807        0.00000000
   z1        0.00011501        0.00082112       -0.03530550
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00094155        0.00108316       -0.00708050
   z2        0.00105674        0.00087619        0.00902750
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00108316        0.00094155        0.00708050
   z3        0.00105674        0.00087619        0.00902750

 ---- MECIOPT (k = 16) ----
            PF, alpha =         7.00000000
             PF, beta =         0.02000000
          Lower state =      -398.66081379 a.u.
          Upper state =      -398.66045519 a.u.
                Sigma =      -398.66063449 a.u.
           Energy gap =         0.00035860 a.u. (        0.00976 eV)

          objective L =      -398.66059027 a.u.
            penalty P =         0.00000632 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00016293|   0.00500000    True
        perpendicular        0.00388851    0.00500000    True
                 step |     -0.00000463|   0.00000100   False
           Energy gap        0.00035860    0.00050000    True

 !NOT PASS: step and grad!

 !UPDATE: G using BFGS

 Line search
 -----------

 linesearch by half step

 make & run input ...
    linesearch.inp
 total wall time: 5.8 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000    0.58001877
        2       H    0.00000000    2.29468199    2.72501722
        3       H    0.00000000   -2.29468199    2.72501722

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52766813
      MULTI         2       2.2   Singlet     -398.51168690
      MULTI         3       1.1   Singlet     -398.68506602

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.65942644
         CI         2       2.2   Singlet     -398.65569853

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.65569853
      Lower     -398.65942644
      SIGMA     -398.65756249
      GAMMA        0.00372791        0.10144170        2.33930184

 make & run input ...
    linesearch.inp
 total wall time: 6.84 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000    0.20871148
        2       H    0.00000000    2.21644586    2.28487776
        3       H    0.00000000   -2.21644586    2.28487776

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52686380
      MULTI         2       2.2   Singlet     -398.50912176
      MULTI         3       1.1   Singlet     -398.69658016

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66142779
         CI         2       2.2   Singlet     -398.65638645

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.65638645
      Lower     -398.66142779
      SIGMA     -398.65890712
      GAMMA        0.00504133        0.13718167        3.16348543

 make & run input ...
    linesearch.inp
 total wall time: 4.12 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000    0.02305784
        2       H    0.00000000    2.17732779    2.06480803
        3       H    0.00000000   -2.17732779    2.06480803

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52128188
      MULTI         2       2.2   Singlet     -398.51388349
      MULTI         3       1.1   Singlet     -398.69872111

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66059220
         CI         2       2.2   Singlet     -398.66030680

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66030680
      Lower     -398.66059220
      SIGMA     -398.66044950
      GAMMA        0.00028539        0.00776592        0.17908640

 make & run input ...
    linesearch.inp
 total wall time: 3.92 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.06976899
        2       H    0.00000000    2.15776876    1.95477316
        3       H    0.00000000   -2.15776876    1.95477316

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52114699
      MULTI         2       2.2   Singlet     -398.51370001
      MULTI         3       1.1   Singlet     -398.70150061

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66075476
         CI         2       2.2   Singlet     -398.66040576

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66040576
      Lower     -398.66075476
      SIGMA     -398.66058026
      GAMMA        0.00034900        0.00949683        0.21900206

 make & run input ...
    linesearch.inp
 total wall time: 4.1 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.11618240
        2       H    0.00000000    2.14798924    1.89975573
        3       H    0.00000000   -2.14798924    1.89975573

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52107199
      MULTI         2       2.2   Singlet     -398.51357179
      MULTI         3       1.1   Singlet     -398.70285365

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66079781
         CI         2       2.2   Singlet     -398.66043718

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66043718
      Lower     -398.66079781
      SIGMA     -398.66061749
      GAMMA        0.00036063        0.00981314        0.22629639

 make & run input ...
    linesearch.inp
 total wall time: 3.76 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.13938910
        2       H    0.00000000    2.14309948    1.87224701
        3       H    0.00000000   -2.14309948    1.87224701

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52103242
      MULTI         2       2.2   Singlet     -398.51349831
      MULTI         3       1.1   Singlet     -398.70352011

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66080918
         CI         2       2.2   Singlet     -398.66044803

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66044803
      Lower     -398.66080918
      SIGMA     -398.66062861
      GAMMA        0.00036115        0.00982750        0.22662751

 make & run input ...
    linesearch.inp
 total wall time: 3.77 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.15099246
        2       H    0.00000000    2.14065460    1.85849265
        3       H    0.00000000   -2.14065460    1.85849265

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52101249
      MULTI         2       2.2   Singlet     -398.51345870
      MULTI         3       1.1   Singlet     -398.70385073

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66081214
         CI         2       2.2   Singlet     -398.66045242

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66045242
      Lower     -398.66081214
      SIGMA     -398.66063228
      GAMMA        0.00035972        0.00978834        0.22572462

 make & run input ...
    linesearch.inp
 total wall time: 3.77 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.15679413
        2       H    0.00000000    2.13943216    1.85161547
        3       H    0.00000000   -2.13943216    1.85161547

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52100227
      MULTI         2       2.2   Singlet     -398.51343843
      MULTI         3       1.1   Singlet     -398.70401537

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66081298
         CI         2       2.2   Singlet     -398.66045423

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66045423
      Lower     -398.66081298
      SIGMA     -398.66063361
      GAMMA        0.00035875        0.00976210        0.22511942

 make & run input ...
    linesearch.inp
 total wall time: 3.88 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.15969497
        2       H    0.00000000    2.13882094    1.84817688
        3       H    0.00000000   -2.13882094    1.84817688

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52099684
      MULTI         2       2.2   Singlet     -398.51342848
      MULTI         3       1.1   Singlet     -398.70409752

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66081333
         CI         2       2.2   Singlet     -398.66045491

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66045491
      Lower     -398.66081333
      SIGMA     -398.66063412
      GAMMA        0.00035842        0.00975322        0.22491459

 make & run input ...
    linesearch.inp
 total wall time: 3.92 sec

 Point group      : Cs
 Symmetry Elements: 

    LABEL    ATOM             X             Y             Z
        1       S    0.00000000    0.00000000   -0.16114539
        2       H    0.00000000    2.13851533    1.84645759
        3       H    0.00000000   -2.13851533    1.84645759

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
      MULTI         1       1.2   Singlet     -398.52099436
      MULTI         2       2.2   Singlet     -398.51342318
      MULTI         3       1.1   Singlet     -398.70413856

    PROGRAM     INDEX     STATE      SPIN      ENERGY(a.u.)
         CI         1       1.2   Singlet     -398.66081339
         CI         2       2.2   Singlet     -398.66045535

      INDEX of Upper = 2, Lower = 1
      STATE      ENERGY(a.u.)              (eV)        (kcal/mol)
      Upper     -398.66045535
      Lower     -398.66081339
      SIGMA     -398.66063437
      GAMMA        0.00035803        0.00974260        0.22466979

              L(k=16) =      -398.66059027
         L(k=16,i=10) =      -398.66059029
                 DIFF =        -0.00000002
 !FIND step length
 !step length =     0.00097656

 Calculates the next step.
 -------------------------

                   p(k)              R(k)             dR(k)            R(k+1)
   x1       -0.00000000        0.00000000       -0.00000000        0.00000000
   y1       -0.00000000        0.00000000       -0.00000000        0.00000000
   z1        1.48522915       -0.16259581        0.00145042       -0.16114539
   x2       -0.00000000        0.00000000       -0.00000000        0.00000000
   y2        0.31294454        2.13820972        0.00030561        2.13851533
   z2        1.76055785        1.84473829        0.00171929        1.84645759
   x3       -0.00000000        0.00000000       -0.00000000        0.00000000
   y3       -0.31294454       -2.13820972       -0.00030561       -2.13851533
   z3        1.76055785        1.84473829        0.00171929        1.84645759

         norm of search direction, |p(k)| =         2.93272946
         norm of next step,       |dR(k)| =         0.00286399
 
 calculate gradients using central difference ...

 make & run input ...
    step_017_nd.inp
 total wall time: 49.55 sec

                  UPPER             LOWER             SIGMA             GAMMA
          -398.66045535     -398.66081339     -398.66063437        0.00035804

                 UPPER+            LOWER+            UPPER-            LOWER-
   x1        0.00000000        0.00000000        0.00000000        0.00000000
   y1     -398.65968778     -398.66157610     -398.65968778     -398.66157610
   z1     -398.66049143     -398.66060614     -398.66029892     -398.66112004
   x2        0.00000000        0.00000000        0.00000000        0.00000000
   y2     -398.66012309     -398.66106475     -398.66013045     -398.66121389
   z2     -398.66014420     -398.66120113     -398.66015412     -398.66103045
   x3        0.00000000        0.00000000        0.00000000        0.00000000
   y3     -398.66013045     -398.66121389     -398.66012309     -398.66106475
   z3     -398.66014420     -398.66120113     -398.66015412     -398.66103045

                 SIGMA+            SIGMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1     -398.66063194     -398.66063194        0.00000000
   z1     -398.66054879     -398.66070948        0.00803475
   x2        0.00000000        0.00000000        0.00000000
   y2     -398.66059392     -398.66067217        0.00391250
   z2     -398.66067266     -398.66059229       -0.00401900
   x3        0.00000000        0.00000000        0.00000000
   y3     -398.66067217     -398.66059392       -0.00391250
   z3     -398.66067266     -398.66059229       -0.00401900

                 GAMMA+            GAMMA-       DIFF/(2*dr)
   x1        0.00000000        0.00000000        0.00000000
   y1        0.00188832        0.00188832        0.00000000
   z1        0.00011471        0.00082112       -0.03532050
   x2        0.00000000        0.00000000        0.00000000
   y2        0.00094166        0.00108344       -0.00708900
   z2        0.00105693        0.00087633        0.00903000
   x3        0.00000000        0.00000000        0.00000000
   y3        0.00108344        0.00094166        0.00708900
   z3        0.00105693        0.00087633        0.00903000

 ---- MECIOPT (k = 17) ----
            PF, alpha =         7.00000000
             PF, beta =         0.02000000
          Lower state =      -398.66081339 a.u.
          Upper state =      -398.66045535 a.u.
                Sigma =      -398.66063437 a.u.
           Energy gap =         0.00035804 a.u. (        0.00974 eV)

          objective L =      -398.66059029 a.u.
            penalty P =         0.00000630 a.u.

    check convergence             value        thresh convsed
             parallel |     -0.00015820|   0.00500000    True
        perpendicular        0.00390280    0.00500000    True
                 step |     -0.00000002|   0.00000100    True
           Energy gap        0.00035804    0.00050000    True

 !BREAK: convergence reached!

 ----------------------------------------------------
 - End of optimization with Penalty-Function method -
 ----------------------------------------------------


 ***********************************************************************
 *                             END MECIOPT                             *
 ***********************************************************************

